# 说明

`logParser.py` 为实现源码：解压后从源文件中按行读取，考虑以下三种情况：

1. 符合正则表达式`\w{3} \d+ (\d{2}):\d{2}:\d{2} ([\w|\.]+) ([\w|\.| ]+)\[(\d+)\](.*)`，说明这是一个事件行，从中提取deviceName, processId, processName, description, timeWindow（由时间戳小时部分得到），并把次数记1。
2. 符合正则表达式`\w{3} \d+ (\d{2}):\d{2}:\d{2} --- last message repeated (\d+) time ---`，说明这是上一个事件行的重复次数，把上一行的记录加上这个次数。
3. 均不符合，判定为上一个行的描述部分为多行，把这一行附加到上一行到记录的description。

考虑到记录行数比较多的情况，定义了一个常数`BATCH_LINES`，每当记录大于等于这个值就把内存中的条目发送到服务器并清空缓存以防止OOM。

几点说明：

* 实际应用中还应考虑根据服务器返回代码重试或报错。
* 这里默认`message repeated x time`和之前的消息在同一个timeWindow。
* 根据题目要求这里不考虑日志的日期，实际中应该考虑把日期附加到header里，并按照日期切分requests。
